
<html>
<head>
  <meta charset="utf-8">
  <style type="text/css">
body {
  margin-left: 3rem;
}

.code {
  font-family: "courier new", monospace;
}

.highlight, p, h1, h2 {
  width: 40rem;
}

p.text-center {
  text-align: center;
}

h1 {
  font-family: Georgia, serif;
  font-size: 50px;
  letter-spacing: -0.02em;
  margin-bottom: 36px;
  line-height: 1em;
  font-weight: 400;
  text-align: center;
}

h2 {
  font-family: Georgia, serif;
  font-weight: 400;
  margin-bottom: 24px;
  margin-top: 48px;
}

body > p {
  font-family: Georgia, serif;
  margin-bottom: 24px;
}

.highlight {
  padding: 0.5rem 1rem;
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  line-height: 1.5;
  position: relative;
}

.with-plot + .highlight,
.highlight + .highlight {
  margin-top: 2px;
}

.highlight + h2,
.highlight + p {
  margin-top: 32px;
}

.file-name {
  float: right;
  font-family: arial, sans-serif;
  color: #666;
  font-size: 12px;
}

.with-plot {
  display: flex;
  flex-direction: row;
}

.with-plot img {
  width: 400px;
  height: auto;
  margin-top: -20px;
}


.highlight { background: #f8f8f8; }                                                                                                                                                                                                                                                                         
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */                                                                                
.highlight .err { border: 1px solid #FF0000 } /* Error */                                                                                         
.highlight .k { color: #008000; font-weight: bold } /* Keyword */                                                                                 
.highlight .o { color: #666666 } /* Operator */                                                                                                   
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */                                                                      
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */                                                                     
.highlight .cp { color: #9C6500 } /* Comment.Preproc */                                                                                           
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */                                                                  
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */                                                                        
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */                                                                       
.highlight .gd { color: #A00000 } /* Generic.Deleted */                                                                                           
.highlight .ge { font-style: italic } /* Generic.Emph */                                                                                          
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */                                                                
.highlight .gr { color: #E40000 } /* Generic.Error */                                                                                             
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */                                                                        
.highlight .gi { color: #008400 } /* Generic.Inserted */                                                                                          
.highlight .go { color: #717171 } /* Generic.Output */                                                                                            
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */                                                                         
.highlight .gs { font-weight: bold } /* Generic.Strong */                                                                                         
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */                                                                     
.highlight .gt { color: #0044DD } /* Generic.Traceback */                                                                                         
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */                                                                       
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */                                                                    
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */                                                                      
.highlight .kp { color: #008000 } /* Keyword.Pseudo */                                                                                            
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */                                                                       
.highlight .kt { color: #B00040 } /* Keyword.Type */                                                                                              
.highlight .m { color: #666666 } /* Literal.Number */                                                                                             
.highlight .s { color: #BA2121 } /* Literal.String */                                                                                             
.highlight .na { color: #687822 } /* Name.Attribute */                                                                                            
.highlight .nb { color: #008000 } /* Name.Builtin */                                                                                              
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */                                                                             
.highlight .no { color: #880000 } /* Name.Constant */                                                                                             
.highlight .nd { color: #AA22FF } /* Name.Decorator */                                                                                            
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */                                                                            
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */                                                                         
.highlight .nf { color: #0000FF } /* Name.Function */                                                                                             
.highlight .nl { color: #767600 } /* Name.Label */                                                                                                
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */                                                                         
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */                                                                               
.highlight .nv { color: #19177C } /* Name.Variable */                                                                                             
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */                                                                          
.highlight .w { color: #bbbbbb } /* Text.Whitespace */                                                                                            
.highlight .mb { color: #666666 } /* Literal.Number.Bin */                                                                                        
.highlight .mf { color: #666666 } /* Literal.Number.Float */                                                                                      
.highlight .mh { color: #666666 } /* Literal.Number.Hex */                                                                                        
.highlight .mi { color: #666666 } /* Literal.Number.Integer */                                                                                    
.highlight .mo { color: #666666 } /* Literal.Number.Oct */                                                                                        
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */                                                                                      
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */                                                                                   
.highlight .sc { color: #BA2121 } /* Literal.String.Char */                                                                                       
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */                                                                                  
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */                                                                    
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */                                                                                     
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */                                                                  
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */                                                                                    
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */                                                                
.highlight .sx { color: #008000 } /* Literal.String.Other */                                                                                      
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */                                                                                      
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */                                                                                     
.highlight .ss { color: #19177C } /* Literal.String.Symbol */                                                                                     
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */                                                                                       
.highlight .fm { color: #0000FF } /* Name.Function.Magic */                                                                                       
.highlight .vc { color: #19177C } /* Name.Variable.Class */                                                                                       
.highlight .vg { color: #19177C } /* Name.Variable.Global */                                                                                      
.highlight .vi { color: #19177C } /* Name.Variable.Instance */                                                                                    
.highlight .vm { color: #19177C } /* Name.Variable.Magic */                                                                                       
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */   

  </style>
</head>
<body>
  <h1>Lineāras vienādojumu sistēmas un funkciju aproksimācija</h1>
<p class="text-center">Einārs Lielmanis, RTU CECA0</p>
<p class="text-center">Risinājumi veikti ar GNU Octave 8.3.</p>
<h2>1a. Atrisināt vienādojumu sistēmu Ax=B</h2>
<pre><code>A = [10 -4 5; 3 -2 7; 1 6 -2]
x = [x1 x2 x3]
B = [7; 5; 3]
</code></pre>
<div class="highlight code"><div class="file-name">src/01a.m</div><pre><span></span><span class="n">d</span> <span class="p">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">m</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">A</span> <span class="p">=</span> <span class="p">[</span> <span class="n">d</span><span class="o">-</span><span class="mi">10</span> <span class="o">-</span><span class="mi">4</span> <span class="mi">5</span><span class="p">;</span>
      <span class="mi">3</span> <span class="n">m</span><span class="o">-</span><span class="mi">5</span> <span class="mi">7</span><span class="p">;</span>
      <span class="mi">1</span> <span class="mi">6</span> <span class="o">-</span><span class="mi">2</span> <span class="p">];</span>
<span class="n">B</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">7</span><span class="p">;</span> <span class="mi">5</span><span class="p">;</span> <span class="mi">3</span> <span class="p">];</span><br>
<span class="n">res</span> <span class="p">=</span> <span class="n">A</span> <span class="o">\</span> <span class="n">B</span><span class="p">;</span>
<span class="nb">assert</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">res</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">tolerance</span> <span class="p">=</span> <span class="mf">0.00001</span><span class="p">);</span><br>
<span class="n">x1</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x2</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x3</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="p">=</span> <span class="o">-</span><span class="mf">4.3750</span>
<span class="n">x2</span> <span class="p">=</span> <span class="mf">2.3125</span>
<span class="n">x3</span> <span class="p">=</span> <span class="mf">3.2500</span>
</pre></div>
<h2>1b-a. Atrisināt sistēmu</h2>
<pre><code>  /
  |  x      - z +  t =  3
 &lt;  2x + 3y - z      =  4
  | 5x          - 3t = -6
  |  x +  y + z +  t =  2
  \
</code></pre>
<div class="highlight code"><div class="file-name">src/01ba.m</div><pre><span></span><span class="n">A</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">1</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">1</span><span class="p">;</span>
      <span class="mi">2</span> <span class="mi">3</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">;</span>
      <span class="mi">5</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">3</span><span class="p">;</span>
      <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="p">];</span>
<span class="n">B</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">3</span><span class="p">;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">-</span><span class="mi">6</span><span class="p">;</span> <span class="mi">2</span> <span class="p">];</span><br>
<span class="n">res</span> <span class="p">=</span> <span class="n">A</span> <span class="o">\</span> <span class="n">B</span><span class="p">;</span>
<span class="nb">assert</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">res</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">tolerance</span> <span class="p">=</span> <span class="mf">0.00001</span><span class="p">);</span><br>
<span class="n">x</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">z</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">t</span> <span class="p">=</span> <span class="n">res</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div><div class="highlight"><pre><span></span><span class="n">x</span> <span class="p">=</span> <span class="mi">0</span>
<span class="n">y</span> <span class="p">=</span> <span class="mi">1</span>
<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mf">1.0000</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">2</span>
</pre></div>
<h2>1b-b. Atrisināt sistēmu</h2>
<pre><code>  /
 | 2x -  y +  z =  9
&lt;   x - 2y + 3z = 10
 | 3x - 3y + 4z =  5
  \
</code></pre>
<div class="highlight code"><div class="file-name">src/01bb.m</div><pre><span></span><span class="n">A</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">2</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">1</span><span class="p">;</span>
      <span class="mi">1</span> <span class="o">-</span><span class="mi">2</span> <span class="mi">3</span><span class="p">;</span>
      <span class="mi">3</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">4</span><span class="p">];</span>
<span class="n">B</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">9</span><span class="p">;</span> <span class="mi">10</span><span class="p">;</span> <span class="mi">5</span> <span class="p">];</span><br>
<span class="n">res</span> <span class="p">=</span> <span class="n">A</span> <span class="o">\</span> <span class="n">B</span>
<span class="c">% matrix singular brīdinājums. Vai nu nav risinājuma, vai bezgalīgi daudz risinājumu</span><br>
<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span> <span class="n">A</span> <span class="o">*</span> <span class="n">res</span> <span class="o">-</span> <span class="n">B</span> <span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.00001</span>
  <span class="c">% atbildē — kaut kas līdzīgs risinājumam</span>
  <span class="nb">disp</span><span class="p">(</span><span class="s">&quot;Bezgalīgi daudz risinājumu?&quot;</span><span class="p">);</span>
<span class="k">else</span>
  <span class="nb">disp</span><span class="p">(</span><span class="s">&quot;Nav risinājumu?&quot;</span><span class="p">);</span>
<span class="k">endif</span>
</pre></div><div class="highlight"><pre><span></span><span class="nb">warning</span><span class="p">:</span> <span class="n">matrix</span> <span class="n">singular</span> <span class="n">to</span> <span class="n">machine</span> <span class="n">precision</span><span class="p">,</span> <span class="nb">rcond</span> <span class="p">=</span> <span class="mf">9.25186e-18</span>
<span class="nb">warning</span><span class="p">:</span> <span class="n">called</span> <span class="n">from</span>
    <span class="p">.</span><span class="n">tmp</span><span class="p">.</span><span class="n">m</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">6</span> <span class="n">column</span> <span class="mi">5</span><br>
<span class="n">res</span> <span class="p">=</span>
   <span class="mf">2.1017e+16</span>
   <span class="mf">1.0508e+17</span>
   <span class="mf">6.3050e+16</span><br>
<span class="n">Nav</span> <span class="n">risinājumu</span>?
</pre></div>
<h2>2. Atrast vienādojuma saknes intervālā [-1; 4]</h2>
<p>sqrt(3) * sin(1.7 x) * log(4.6 - x) = 0</p>
<p>Ziņkārības pēc, apskatīsim grafiku:</p>
<div class="with-plot"><div class="highlight code"><div class="file-name">src/02-plot.m</div><pre><span></span><span class="n">from</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">to</span> <span class="p">=</span> <span class="mi">4</span><span class="p">;</span><br>
<span class="n">xs</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">ys</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">.*</span> <span class="nb">sin</span><span class="p">(</span><span class="mf">1.7</span> <span class="o">.*</span> <span class="n">xs</span><span class="p">)</span> <span class="o">.*</span> <span class="nb">log</span><span class="p">(</span><span class="mf">4.6</span> <span class="o">-</span> <span class="n">xs</span><span class="p">)</span><br>
<span class="nb">plot</span><span class="p">([</span><span class="n">from</span> <span class="n">to</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span> <span class="mi">3</span><span class="p">],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span><br>
<span class="nb">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">);</span>
</pre></div><div class="plot"><img src="plot-1.png"></div></div>
<p>Uz aci izskatās, ka saknes ir trīs (kaut iespējams, ap 3.6 ir divas, ja kūkums šķērso y asi, nevis tai tikai pieskaras).</p>
<p>Izmantosim <code>symbolic</code> paciņu, lai atrisinātu šo vienādojumu pa īstam.</p>
<div class="highlight code"><div class="file-name">src/02-solve.m</div><pre><span></span><span class="n">pkg</span> <span class="nb">load</span> <span class="n">symbolic</span><span class="p">;</span><br>
<span class="n">syms</span> <span class="n">x</span><span class="p">;</span><br>
<span class="n">f</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">17</span><span class="o">/</span><span class="mi">10</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="nb">log</span><span class="p">(</span><span class="mi">46</span><span class="o">/</span><span class="mi">10</span> <span class="o">-</span> <span class="n">x</span><span class="p">);</span><br>
<span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><br>
<span class="n">x1</span> <span class="p">=</span> <span class="mi">0</span>
<span class="n">x2</span> <span class="p">=</span> <span class="mi">18</span><span class="o">/</span><span class="mi">5</span>
<span class="n">x3</span> <span class="p">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="nb">pi</span> <span class="o">/</span> <span class="mi">17</span>
</pre></div><div class="highlight"><pre><span></span><span class="n">Symbolic</span> <span class="n">pkg</span> <span class="n">v3</span><span class="p">.</span><span class="mf">1.1</span><span class="p">:</span> <span class="n">Python</span> <span class="n">communication</span> <span class="nb">link</span> <span class="n">active</span><span class="p">,</span> <span class="n">SymPy</span> <span class="n">v1</span><span class="p">.</span><span class="mf">12.</span>
<span class="nb">warning</span><span class="p">:</span> <span class="n">passing</span> <span class="n">floating</span><span class="o">-</span><span class="n">point</span> <span class="n">values</span> <span class="n">to</span> <span class="n">sym</span> <span class="n">is</span> <span class="n">dangerous</span><span class="p">,</span> <span class="n">see</span> <span class="s">&quot;help sym&quot;</span>
<span class="nb">warning</span><span class="p">:</span> <span class="n">called</span> <span class="n">from</span>
    <span class="n">double_to_sym_heuristic</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">50</span> <span class="n">column</span> <span class="mi">7</span>
    <span class="n">sym</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">379</span> <span class="n">column</span> <span class="mi">13</span>
    <span class="nb">mtimes</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">54</span> <span class="n">column</span> <span class="mi">5</span>
    <span class="p">.</span><span class="n">tmp</span><span class="p">.</span><span class="n">m</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">5</span> <span class="n">column</span> <span class="mi">3</span><br>
<span class="nb">warning</span><span class="p">:</span> <span class="n">passing</span> <span class="n">floating</span><span class="o">-</span><span class="n">point</span> <span class="n">values</span> <span class="n">to</span> <span class="n">sym</span> <span class="n">is</span> <span class="n">dangerous</span><span class="p">,</span> <span class="n">see</span> <span class="s">&quot;help sym&quot;</span>
<span class="nb">warning</span><span class="p">:</span> <span class="n">called</span> <span class="n">from</span>
    <span class="n">double_to_sym_heuristic</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">50</span> <span class="n">column</span> <span class="mi">7</span>
    <span class="n">sym</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">379</span> <span class="n">column</span> <span class="mi">13</span>
    <span class="nb">mtimes</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">54</span> <span class="n">column</span> <span class="mi">5</span>
    <span class="p">.</span><span class="n">tmp</span><span class="p">.</span><span class="n">m</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">5</span> <span class="n">column</span> <span class="mi">3</span><br>
<span class="nb">warning</span><span class="p">:</span> <span class="n">passing</span> <span class="n">floating</span><span class="o">-</span><span class="n">point</span> <span class="n">values</span> <span class="n">to</span> <span class="n">sym</span> <span class="n">is</span> <span class="n">dangerous</span><span class="p">,</span> <span class="n">see</span> <span class="s">&quot;help sym&quot;</span>
<span class="nb">warning</span><span class="p">:</span> <span class="n">called</span> <span class="n">from</span>
    <span class="n">double_to_sym_heuristic</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">50</span> <span class="n">column</span> <span class="mi">7</span>
    <span class="n">sym</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">379</span> <span class="n">column</span> <span class="mi">13</span>
    <span class="nb">minus</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">47</span> <span class="n">column</span> <span class="mi">5</span>
    <span class="p">.</span><span class="n">tmp</span><span class="p">.</span><span class="n">m</span> <span class="n">at</span> <span class="nb">line</span> <span class="mi">5</span> <span class="n">column</span> <span class="mi">3</span><br>
<span class="n">ans</span> <span class="p">=</span> <span class="p">(</span><span class="n">sym</span> <span class="mi">3</span>×<span class="mi">1</span> <span class="n">matrix</span><span class="p">)</span>
  ⎡ <span class="mi">0</span>  ⎤
  ⎢    ⎥
  ⎢<span class="mi">18</span><span class="o">/</span><span class="mi">5</span>⎥
  ⎢    ⎥
  ⎢<span class="mi">10</span>⋅π⎥
  ⎢────⎥
  ⎣ <span class="mi">17</span> ⎦
<span class="n">x1</span> <span class="p">=</span> <span class="mi">0</span>
<span class="n">x2</span> <span class="p">=</span> <span class="mf">3.6000</span>
<span class="n">x3</span> <span class="p">=</span> <span class="mf">1.8480</span>
</pre></div>
<p>Nē, atbildes ir tikai trīs: X = 0, X = 1.848 un X = 3.6.</p>
<h2>3. Aprēķināt ar vidējo taisnstūru metodi noteikto integrāli</h2>
<p>2. variants:</p>
<p>f(x) = sin(x + sqrt(x))</p>
<p>a = 0, b = 12</p>
<div class="highlight code"><div class="file-name">src/03-solve-quad.m</div><pre><span></span><span class="n">f</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="nb">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">));</span><br>
<span class="n">a</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">b</span> <span class="p">=</span> <span class="mi">12</span><span class="p">;</span><br>
<span class="k">function</span><span class="w"> </span>retval<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">tainst_integr </span><span class="p">(</span>f, a, b, n<span class="p">)</span>
<span class="w">  </span><span class="n">pts</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
  <span class="n">width</span> <span class="p">=</span> <span class="n">pts</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">pts</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">midpoints</span> <span class="p">=</span> <span class="n">pts</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">retval</span> <span class="p">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">midpoints</span><span class="p">)</span> <span class="o">*</span> <span class="n">width</span><span class="p">);</span>
<span class="k">end</span><br>
<span class="c">% laba atbilde</span>
<span class="n">a_quad</span> <span class="p">=</span> <span class="nb">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><br>
<span class="c">% tainsntūru metode</span>
<span class="n">a_6</span> <span class="p">=</span> <span class="n">tainst_integr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">a_50</span> <span class="p">=</span> <span class="n">tainst_integr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">a_100</span> <span class="p">=</span> <span class="n">tainst_integr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><br>
<span class="n">err_100</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a_100</span> <span class="o">-</span> <span class="n">a_quad</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">a_quad</span>
</pre></div><div class="highlight"><pre><span></span><span class="n">a_quad</span> <span class="p">=</span> <span class="mf">1.3144</span>
<span class="n">a_6</span> <span class="p">=</span> <span class="mf">0.026410</span>
<span class="n">a_50</span> <span class="p">=</span> <span class="mf">1.3524</span>
<span class="n">a_100</span> <span class="p">=</span> <span class="mf">1.3393</span>
<span class="n">err_100</span> <span class="p">=</span> <span class="mf">1.8941</span>
</pre></div>
<p>Secināms, ka tainstūru metode ir ļoti slikta aproksimācija — pat ar šī nelielā intervāla dalīšanu 100 daļās, kļūda ir gandrīz 2%, kamēr sešu daļu dalīšana neder pavisam nekam.</p>
<p>Ideja: uzzīmēt grafiku ar sešiem taisnstūrīšiem virsū, lai redzētu, cik tas baisi izskatās?</p>
<h2>3. Simpsona metode</h2>
<div class="highlight code"><div class="file-name">src/03-solve-simpson.m</div><pre><span></span><span class="n">f</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="nb">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">));</span><br>
<span class="n">a</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">b</span> <span class="p">=</span> <span class="mi">12</span><span class="p">;</span><br>
<span class="k">function</span><span class="w"> </span>retval<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">integr_simpson</span><span class="p">(</span>f, a, b, n<span class="p">)</span>
<span class="w">  </span><span class="c">% https://en.wikipedia.org/wiki/Simpson&#39;s_rule</span>
  <span class="n">xs</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span><br>
  <span class="n">retval</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="n">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="n">pa</span> <span class="p">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">pb</span> <span class="p">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">retval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">pb</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">pa</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">f</span><span class="p">((</span><span class="n">pa</span> <span class="o">+</span> <span class="n">pb</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">pb</span><span class="p">));</span>
  <span class="k">end</span>
<span class="k">end</span><br>
<span class="n">a_quad</span> <span class="p">=</span> <span class="nb">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="n">a_simp</span> <span class="p">=</span> <span class="n">integr_simpson</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><br>
<p><span class="n">err_simp</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a_simp</span> <span class="o">-</span> <span class="n">a_quad</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">a_quad</span>
</pre></div><div class="highlight"><pre><span></span><span class="n">a_simp</span> <span class="p">=</span> <span class="mf">1.3133</span>
<span class="n">err_simp</span> <span class="p">=</span> <span class="mf">0.090878</span>
</pre></div></p>
<p>Simpsona metodei nav ne vainas: ar vien divdesmit dalījumiem, kļūda ir &lt;1%.</p>
<p>Nav parādīts kodā, bet ar n=100, kļūda ir &lt;0.1%.</p>
<h2>4. Figūras laukuma aprēķins</h2>
<p>Figūras laukumu dalīsim divās daļās. Kreiso kārtu izteiksim kā trešās pakāpes polinomu,</p>
<p>Kreisā daļa:</p>
<div class="with-plot"><div class="highlight code"><div class="file-name">src/04-approx-left.m</div><pre><span></span><span class="c">%%% glītas asis</span>
<span class="n">a</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="mi">6</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">7</span><span class="p">];</span>
<span class="nb">plot</span><span class="p">([</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">axis</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><br>
<p><span class="n">xs</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="o">-</span><span class="mf">1.5</span> <span class="o">-</span><span class="mi">3</span>   <span class="o">-</span><span class="mi">2</span><span class="p">];</span>
<span class="n">ys</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">0</span>  <span class="mi">2</span>    <span class="mf">4.5</span>  <span class="mi">6</span><span class="p">];</span><br>
<span class="c">% polifitojam ar x un y samainītiem vietām</span>
<span class="n">params</span> <span class="p">=</span> <span class="nb">polyfit</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="o">-</span><span class="n">xs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><br>
<span class="n">f_left</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="nb">polyval</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span><br>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span><br>
<span class="nb">plot</span><span class="p">(</span><span class="o">-</span><span class="n">f_left</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="s">'color'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span><br>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span><br>
<span class="nb">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span> <span class="mi">6</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="s">'color'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span><br></p>
<p><span class="c">% 1 x 6 = taisnstūris līdz y asij</span>
<span class="n">area_left</span> <span class="p">=</span> <span class="nb">quad</span><span class="p">(</span><span class="n">f_left</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="mi">6</span>
</pre></div><div class="plot"><img src="plot-2.png"></div></div><div class="highlight"><pre><span></span><span class="n">params</span> <span class="p">=</span>
<span class="o">-</span><span class="mf">0.1213</span>   <span class="mf">1.1995</span>  <span class="o">-</span><span class="mf">3.1639</span>   <span class="mf">4.0000</span><br>
<span class="n">area_left</span> <span class="p">=</span> <span class="mf">8.1167</span>
</pre></div></p>
<p>Labā daļa:</p>
<div class="with-plot"><div class="highlight code"><div class="file-name">src/04-approx-right.m</div><pre><span></span><span class="c">%%% glītas asis</span>
<span class="n">a</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="mi">6</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">7</span><span class="p">];</span>
<span class="nb">plot</span><span class="p">([</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">axis</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><br>
<span class="n">xs</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">5</span><span class="p">];</span>
<span class="n">ys</span> <span class="p">=</span> <span class="p">[</span><span class="mi">6</span> <span class="mi">1</span><span class="p">];</span><br>
<span class="c">% oktāva nemāk fitot eksponenti, tapēc nācās nopūsties, paņemt matlabu un iefitot koeficientus,</span>
<span class="n">f_right_a</span> <span class="p">=</span> <span class="mf">1.844</span>
<span class="n">f_right_b</span> <span class="p">=</span> <span class="mf">0.987</span><br>
<span class="n">f_right</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="n">f_right_a</span> <span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f_right_b</span><span class="p">;</span><br>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span><br>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_right</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">);</span><br>
<span class="nb">plot</span><span class="p">([</span><span class="mi">5</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">6</span><span class="p">],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">);</span><br>
<span class="n">area_right</span> <span class="p">=</span> <span class="nb">quad</span><span class="p">(</span><span class="n">f_right</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div><div class="plot"><img src="plot-3.png"></div></div><div class="highlight"><pre><span></span><span class="n">f_right_a</span> <span class="p">=</span> <span class="mf">1.8440</span>
<span class="n">f_right_b</span> <span class="p">=</span> <span class="mf">0.9870</span>
<span class="n">area_right</span> <span class="p">=</span> <span class="mf">10.922</span>
</pre></div>
<p>Gala aprēķins un ilustrācija:</p>
<div class="with-plot"><div class="highlight code"><div class="file-name">src/04-total.m</div><pre><span></span><span class="c">%%% glītas asis</span>
<span class="n">a</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="mi">6</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">7</span><span class="p">];</span>
<span class="nb">plot</span><span class="p">([</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;#aaa&#39;</span><span class="p">);</span>
<span class="nb">axis</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><br>
<span class="c">% no iepriekšējiem aprēķiniem</span>
<span class="n">area_left</span> <span class="p">=</span> <span class="mf">8.1167</span>
<span class="n">area_right</span> <span class="p">=</span> <span class="mf">10.922</span><br>
<span class="n">area_total</span> <span class="p">=</span> <span class="n">area_left</span> <span class="o">+</span> <span class="n">area_right</span><br>
<span class="n">params_left</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1213</span>   <span class="mf">1.1995</span>  <span class="o">-</span><span class="mf">3.1639</span>   <span class="mf">4.0000</span><span class="p">];</span>
<span class="n">f_left</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="nb">polyval</span><span class="p">(</span><span class="n">params_left</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
<span class="n">f_right_a</span> <span class="p">=</span> <span class="mf">1.844</span><span class="p">;</span>
<span class="n">f_right_b</span> <span class="p">=</span> <span class="mf">0.987</span><span class="p">;</span>
<span class="n">f_right</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="n">f_right_a</span> <span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f_right_b</span><span class="p">;</span><br>
<p><span class="c">% kreisā līnija</span>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="o">-</span><span class="n">f_left</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="s">'color'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span><br>
<span class="c">% horizontālais knariņš</span>
<span class="nb">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span> <span class="mi">6</span><span class="p">],</span> <span class="s">'color'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span><br>
<span class="c">% eksponente</span>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_right</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s">'color'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span><br>
<span class="c">% atlikušais stūris</span>
<span class="nb">plot</span><span class="p">([</span><span class="mi">5</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="s">'color'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span>
</pre></div><div class="plot"><img src="plot-4.png"></div></div><div class="highlight"><pre><span></span><span class="n">area_left</span> <span class="p">=</span> <span class="mf">8.1167</span>
<span class="n">area_right</span> <span class="p">=</span> <span class="mf">10.922</span>
<span class="n">area_total</span> <span class="p">=</span> <span class="mf">19.039</span>
</pre></div></p>
<hr>
<p>Paskatīties kodu, kurš šo visu veidojis, <a href="https://github.com/einars/matlab-01">githabā</a></p>

</body>
</html>
